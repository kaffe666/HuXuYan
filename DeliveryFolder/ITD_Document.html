<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ITD Document - Best Bike Paths (BBP)</title>
    <style>
        @media print {
            body { font-size: 11pt; }
            h1 { page-break-before: always; }
            h1:first-of-type { page-break-before: avoid; }
            table { page-break-inside: avoid; }
            pre { page-break-inside: avoid; }
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        
        h1 {
            color: #1a365d;
            border-bottom: 3px solid #2563eb;
            padding-bottom: 10px;
            margin-top: 40px;
        }
        
        h2 {
            color: #1e40af;
            border-bottom: 1px solid #93c5fd;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        
        h3 {
            color: #1e3a8a;
            margin-top: 25px;
        }
        
        h4 {
            color: #3730a3;
            margin-top: 20px;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-size: 0.9em;
        }
        
        th, td {
            border: 1px solid #d1d5db;
            padding: 10px 12px;
            text-align: left;
        }
        
        th {
            background-color: #1e40af;
            color: white;
            font-weight: 600;
        }
        
        tr:nth-child(even) {
            background-color: #f3f4f6;
        }
        
        tr:hover {
            background-color: #e5e7eb;
        }
        
        code {
            background-color: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            color: #1e40af;
        }
        
        pre {
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85em;
            line-height: 1.5;
        }
        
        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }
        
        blockquote {
            border-left: 4px solid #2563eb;
            margin: 20px 0;
            padding: 10px 20px;
            background-color: #eff6ff;
            color: #1e40af;
        }
        
        hr {
            border: none;
            border-top: 2px solid #e5e7eb;
            margin: 30px 0;
        }
        
        a {
            color: #2563eb;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        ul, ol {
            padding-left: 25px;
        }
        
        li {
            margin: 8px 0;
        }
        
        .cover-page {
            text-align: center;
            padding: 60px 0;
            border-bottom: 3px solid #2563eb;
            margin-bottom: 40px;
        }
        
        .cover-page h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            border: none;
        }
        
        .cover-page h2 {
            font-size: 1.5em;
            color: #64748b;
            border: none;
            margin-top: 0;
        }
        
        /* Status indicators */
        td:contains("✅") { color: #16a34a; }
        td:contains("❌") { color: #dc2626; }
    </style>
</head>
<body>
<h1 id="implementation-and-test-deliverable-itd">Implementation and Test Deliverable (ITD)</h1>
<h1 id="best-bike-paths-bbp-road-application">Best Bike Paths (BBP) Road Application</h1>
<hr />
<h2 id="front-page">Front Page</h2>
<table>
<thead>
<tr>
<th><strong>Document Information</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Project Name</strong></td>
<td>Best Bike Paths (BBP)</td>
</tr>
<tr>
<td><strong>Document Type</strong></td>
<td>Implementation and Test Deliverable (ITD)</td>
</tr>
<tr>
<td><strong>Version</strong></td>
<td>1.0</td>
</tr>
<tr>
<td><strong>Date</strong></td>
<td>January 30, 2026</td>
</tr>
<tr>
<td><strong>Course</strong></td>
<td>Software Engineering 2</td>
</tr>
</tbody>
</table>
<h3 id="team-members">Team Members</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Student ID</th>
<th>Email</th>
</tr>
</thead>
<tbody>
<tr>
<td>[Hu Xu Yan]</td>
<td>[Student ID]</td>
<td>[email@polimi.it]</td>
</tr>
<tr>
<td>[Team Member 2]</td>
<td>[Student ID]</td>
<td>[email@polimi.it]</td>
</tr>
<tr>
<td>[Team Member 3]</td>
<td>[Student ID]</td>
<td>[email@polimi.it]</td>
</tr>
</tbody>
</table>
<h3 id="software-links">Software Links</h3>
<table>
<thead>
<tr>
<th>Resource</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Source Code</strong></td>
<td><code>DeliveryFolder/bbp-road-app/</code></td>
</tr>
<tr>
<td><strong>Backend Source</strong></td>
<td><code>DeliveryFolder/bbp-road-app/backend/main.py</code></td>
</tr>
<tr>
<td><strong>Frontend Source</strong></td>
<td><code>DeliveryFolder/bbp-road-app/frontend/src/</code></td>
</tr>
<tr>
<td><strong>Installation Files</strong></td>
<td><code>DeliveryFolder/bbp-road-app/</code></td>
</tr>
<tr>
<td><strong>Node.js Runtime</strong></td>
<td><code>DeliveryFolder/bbp-road-app/node-v20.19.0-win-x64/</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#1-introduction">Introduction</a></li>
<li><a href="#2-scope-of-the-document">Scope of the Document</a></li>
<li><a href="#3-implemented-requirements-and-functions">Implemented Requirements and Functions</a></li>
<li><a href="#4-adopted-development-frameworks">Adopted Development Frameworks</a></li>
<li><a href="#5-structure-of-the-source-code">Structure of the Source Code</a></li>
<li><a href="#6-testing">Testing</a></li>
<li><a href="#7-installation-instructions">Installation Instructions</a></li>
<li><a href="#8-effort-spent">Effort Spent</a></li>
<li><a href="#9-references">References</a></li>
</ol>
<hr />
<h2 id="1-introduction">1. Introduction</h2>
<p>The Best Bike Paths (BBP) application is a comprehensive road condition monitoring and route planning system designed specifically for cyclists. The system enables users to:</p>
<ul>
<li>Report and track road conditions (potholes, surface quality, obstacles)</li>
<li>Plan optimal cycling routes based on road quality data</li>
<li>Contribute to a community-driven road quality database</li>
<li>Receive intelligent route recommendations with safety scoring</li>
</ul>
<p>This document describes the implementation details of the BBP prototype, including the architectural decisions, implemented features, testing procedures, and installation instructions.</p>
<h3 id="11-purpose">1.1 Purpose</h3>
<p>This ITD document serves as the technical reference for the BBP implementation, providing:</p>
<ul>
<li>Documentation of all implemented functionalities</li>
<li>Justification for technology choices</li>
<li>Comprehensive testing results</li>
<li>Step-by-step installation guide for deployment</li>
</ul>
<h3 id="12-definitions-acronyms-and-abbreviations">1.2 Definitions, Acronyms, and Abbreviations</h3>
<table>
<thead>
<tr>
<th>Term</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>BBP</td>
<td>Best Bike Paths</td>
</tr>
<tr>
<td>OSRM</td>
<td>Open Source Routing Machine</td>
</tr>
<tr>
<td>API</td>
<td>Application Programming Interface</td>
</tr>
<tr>
<td>REST</td>
<td>Representational State Transfer</td>
</tr>
<tr>
<td>CRUD</td>
<td>Create, Read, Update, Delete</td>
</tr>
<tr>
<td>i18n</td>
<td>Internationalization</td>
</tr>
<tr>
<td>SPA</td>
<td>Single Page Application</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-scope-of-the-document">2. Scope of the Document</h2>
<p>This document covers the complete implementation of the BBP road application prototype, including:</p>
<ol>
<li><strong>Backend Implementation</strong>: FastAPI-based REST API server with in-memory data storage</li>
<li><strong>Frontend Implementation</strong>: React-based Single Page Application with interactive maps</li>
<li><strong>Integration</strong>: OSRM routing service integration for real road geometry</li>
<li><strong>Testing</strong>: Unit tests and system-level test cases</li>
<li><strong>Deployment</strong>: Installation and configuration instructions</li>
</ol>
<h3 id="21-document-boundaries">2.1 Document Boundaries</h3>
<p>This document focuses on:
- ✅ Implemented prototype features
- ✅ Technical architecture and code structure
- ✅ Testing methodology and results
- ✅ Installation procedures</p>
<p>This document does NOT cover:
- ❌ Production deployment configurations
- ❌ Performance optimization strategies
- ❌ Future enhancement roadmap</p>
<hr />
<h2 id="3-implemented-requirements-and-functions">3. Implemented Requirements and Functions</h2>
<h3 id="31-implemented-features-overview">3.1 Implemented Features Overview</h3>
<table>
<thead>
<tr>
<th>Feature Category</th>
<th>Feature</th>
<th>Status</th>
<th>Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>User Management</strong></td>
<td>User Registration</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td></td>
<td>User Settings</td>
<td>✅ Implemented</td>
<td>Medium</td>
</tr>
<tr>
<td></td>
<td>Multi-language Support</td>
<td>✅ Implemented</td>
<td>Medium</td>
</tr>
<tr>
<td><strong>Segment Management</strong></td>
<td>Create Road Segments</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td></td>
<td>View Segments on Map</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td></td>
<td>Segment Status Tracking</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td><strong>Report System</strong></td>
<td>Submit Condition Reports</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td></td>
<td>Report Confirmation</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td></td>
<td>Weighted Voting Aggregation</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td></td>
<td>Batch Confirmation</td>
<td>✅ Implemented</td>
<td>Medium</td>
</tr>
<tr>
<td><strong>Route Planning</strong></td>
<td>OSRM Route Integration</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td></td>
<td>Generate &amp; Evaluate Algorithm</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td></td>
<td>Route Quality Scoring</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td></td>
<td>Multiple Route Alternatives</td>
<td>✅ Implemented</td>
<td>Medium</td>
</tr>
<tr>
<td><strong>Trip Management</strong></td>
<td>Create Trips</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td></td>
<td>Trip History</td>
<td>✅ Implemented</td>
<td>Medium</td>
</tr>
<tr>
<td></td>
<td>Privacy Protection</td>
<td>✅ Implemented</td>
<td>High</td>
</tr>
<tr>
<td><strong>Auto Detection</strong></td>
<td>Sensor-based Detection</td>
<td>✅ Implemented</td>
<td>Medium</td>
</tr>
<tr>
<td></td>
<td>Auto-confirm Reports</td>
<td>✅ Implemented</td>
<td>Low</td>
</tr>
<tr>
<td><strong>Weather Service</strong></td>
<td>Weather Information</td>
<td>✅ Implemented</td>
<td>Low</td>
</tr>
<tr>
<td></td>
<td>Cycling Recommendations</td>
<td>✅ Implemented</td>
<td>Low</td>
</tr>
<tr>
<td><strong>Internationalization</strong></td>
<td>English (en)</td>
<td>✅ Implemented</td>
<td>Medium</td>
</tr>
<tr>
<td></td>
<td>Chinese (zh)</td>
<td>✅ Implemented</td>
<td>Medium</td>
</tr>
<tr>
<td></td>
<td>Italian (it)</td>
<td>✅ Implemented</td>
<td>Medium</td>
</tr>
</tbody>
</table>
<h3 id="32-detailed-feature-descriptions">3.2 Detailed Feature Descriptions</h3>
<h4 id="321-user-management">3.2.1 User Management</h4>
<p><strong>Implementation</strong>: Users can register with a username. The system stores user preferences including language, dark mode, notification settings, and default map configurations.</p>
<pre><code>API Endpoints:
- POST /api/users - Create or get user
- GET /api/users - List all users
- GET /api/users/{user_id}/settings - Get user settings
- PUT /api/users/{user_id}/settings - Update user settings
- PATCH /api/users/{user_id}/settings - Partial update settings
</code></pre>
<p><strong>Motivation</strong>: User management is essential for personalized experience and tracking individual contributions to the road condition database.</p>
<h4 id="322-road-segment-management">3.2.2 Road Segment Management</h4>
<p><strong>Implementation</strong>: Road segments are defined by start and end GPS coordinates with associated status (optimal, medium, suboptimal, maintenance) and optional obstacle information.</p>
<pre><code>API Endpoints:
- GET /api/segments - List all segments (with localized status)
- POST /api/segments - Create new segment
</code></pre>
<p><strong>Status Classification</strong>:
| Status | Description | Color Code |
|--------|-------------|------------|
| Optimal | Excellent road condition | Green |
| Medium | Fair condition, minor issues | Yellow |
| Suboptimal | Poor condition, caution advised | Orange |
| Maintenance | Under repair, avoid if possible | Red |</p>
<h4 id="323-report-system-with-weighted-voting">3.2.3 Report System with Weighted Voting</h4>
<p><strong>Implementation</strong>: Users submit reports for road segments. The system uses a weighted voting algorithm to aggregate reports and automatically update segment status.</p>
<p><strong>Weighting Algorithm</strong>:</p>
<pre><code class="language-python">Weight Calculation:
- Base weight: 1.0
- Fresh report (&lt; 30 days): ×2.0 multiplier
- Confirmed report: ×1.5 multiplier

Status Determination:
- negative_score &gt;= 0.6 → &quot;maintenance&quot;
- negative_score &gt;= 0.3 → &quot;medium&quot;  
- positive_score &gt; 0.7 → &quot;optimal&quot;
- Otherwise → &quot;medium&quot;
</code></pre>
<p><strong>Motivation</strong>: Weighted voting ensures that recent and verified reports have greater influence on road status, improving data accuracy over time.</p>
<h4 id="324-route-planning-with-quality-scoring">3.2.4 Route Planning with Quality Scoring</h4>
<p><strong>Implementation</strong>: The "Generate &amp; Evaluate" algorithm provides intelligent route recommendations:</p>
<p><strong>Phase 1: Candidate Generation</strong>
1. Direct route from OSRM
2. Routes via perpendicular waypoints (15% offset)
3. Deduplication of similar routes (&gt;80% overlap)</p>
<p><strong>Phase 2: Scoring</strong></p>
<pre><code>Score = Distance + Penalty

Penalty Calculation by Preference:
┌─────────────┬──────────────┬──────────────┬────────────┐
│ Factor      │ safety_first │ balanced     │ shortest   │
├─────────────┼──────────────┼──────────────┼────────────┤
│ Pothole     │ 1200         │ 500          │ 100        │
│ Maintenance │ 10.0×length  │ 4.0×length   │ 0.8×length │
│ Bad Road    │ 5.0×length   │ 2.0×length   │ 0.3×length │
│ Medium Road │ 1.5×length   │ 0.5×length   │ 0.1×length │
└─────────────┴──────────────┴──────────────┴────────────┘
</code></pre>
<p><strong>Phase 3: Tagging</strong>
- "Recommended" - Top-ranked route
- "Alternative" - Other viable routes
- "Best Surface" - Quality score &gt; 90
- "Fastest" - Shortest distance
- "Bumpy", "Road Work", "Poor Surface" - Warning tags</p>
<h4 id="325-privacy-by-design">3.2.5 Privacy By Design</h4>
<p><strong>Implementation</strong>: Location privacy protection following GDPR principles:</p>
<ol>
<li><strong>Location Obfuscation</strong>: Start/end points fuzzed by ~150m</li>
<li><strong>Coordinate Truncation</strong>: Public coordinates rounded to 3 decimal places (~100m precision)</li>
<li><strong>Trip Geometry Sanitization</strong>: First and last 150m of trip routes obfuscated</li>
<li><strong>Private Data Separation</strong>: Raw coordinates stored separately, only accessible by owner</li>
</ol>
<pre><code class="language-python">Privacy Methods:
- &quot;noise&quot;: Random offset within 150m radius
- &quot;grid&quot;: Snap to 200m grid
- &quot;truncate&quot;: Round to 3 decimal places
</code></pre>
<h3 id="33-excluded-features-and-justification">3.3 Excluded Features and Justification</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Reason for Exclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td>User Authentication (JWT)</td>
<td>Simplified for prototype; username-based identification sufficient for demo</td>
</tr>
<tr>
<td>Persistent Database</td>
<td>In-memory storage suitable for prototype; reduces deployment complexity</td>
</tr>
<tr>
<td>Real-time Notifications</td>
<td>Would require WebSocket infrastructure; deferred to future iteration</td>
</tr>
<tr>
<td>Mobile App</td>
<td>Web-based SPA provides cross-platform access; native app not required for prototype</td>
</tr>
<tr>
<td>Social Features</td>
<td>Core functionality prioritized; social features are enhancement, not essential</td>
</tr>
<tr>
<td>Payment Integration</td>
<td>Out of scope for academic prototype</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4-adopted-development-frameworks">4. Adopted Development Frameworks</h2>
<h3 id="41-programming-languages">4.1 Programming Languages</h3>
<h4 id="411-backend-python-310">4.1.1 Backend: Python 3.10+</h4>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Version</strong></td>
<td>Python 3.10 or higher</td>
</tr>
<tr>
<td><strong>Paradigm</strong></td>
<td>Multi-paradigm (OOP, Functional)</td>
</tr>
</tbody>
</table>
<p><strong>Advantages</strong>:
- ✅ Rapid development with clean, readable syntax
- ✅ Excellent library ecosystem (FastAPI, Pydantic, httpx)
- ✅ Strong type hints support for better code quality
- ✅ Easy integration with scientific computing libraries
- ✅ Large community and extensive documentation</p>
<p><strong>Disadvantages</strong>:
- ❌ Slower execution compared to compiled languages
- ❌ Global Interpreter Lock (GIL) limits true parallelism
- ❌ Memory consumption higher than C/C++</p>
<p><strong>Justification</strong>: Python's rapid development capabilities and the excellent FastAPI framework make it ideal for building REST APIs quickly while maintaining code quality through type hints.</p>
<h4 id="412-frontend-typescript-59">4.1.2 Frontend: TypeScript 5.9</h4>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Version</strong></td>
<td>TypeScript ~5.9.3</td>
</tr>
<tr>
<td><strong>Paradigm</strong></td>
<td>Object-oriented, Functional</td>
</tr>
</tbody>
</table>
<p><strong>Advantages</strong>:
- ✅ Static type checking catches errors at compile time
- ✅ Enhanced IDE support with autocompletion
- ✅ Better code maintainability and refactoring
- ✅ Seamless integration with React ecosystem
- ✅ Industry standard for modern web development</p>
<p><strong>Disadvantages</strong>:
- ❌ Additional compilation step required
- ❌ Learning curve for developers new to static typing
- ❌ Type definitions may lag behind JavaScript libraries</p>
<p><strong>Justification</strong>: TypeScript provides the type safety necessary for maintaining a complex React application while leveraging the vast JavaScript ecosystem.</p>
<h3 id="42-frameworks">4.2 Frameworks</h3>
<h4 id="421-backend-framework-fastapi">4.2.1 Backend Framework: FastAPI</h4>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Version</strong></td>
<td>Latest stable</td>
</tr>
<tr>
<td><strong>Type</strong></td>
<td>Async Web Framework</td>
</tr>
</tbody>
</table>
<p><strong>Advantages</strong>:
- ✅ Automatic OpenAPI (Swagger) documentation generation
- ✅ Built-in request validation via Pydantic
- ✅ Native async/await support for high performance
- ✅ Dependency injection system
- ✅ Excellent developer experience</p>
<p><strong>Disadvantages</strong>:
- ❌ Relatively new compared to Django/Flask
- ❌ Smaller plugin ecosystem
- ❌ Async programming complexity for beginners</p>
<h4 id="422-frontend-framework-react-19">4.2.2 Frontend Framework: React 19</h4>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Version</strong></td>
<td>React 19.2.0</td>
</tr>
<tr>
<td><strong>Type</strong></td>
<td>UI Component Library</td>
</tr>
</tbody>
</table>
<p><strong>Advantages</strong>:
- ✅ Component-based architecture promotes reusability
- ✅ Virtual DOM for efficient rendering
- ✅ Hooks API for state management
- ✅ Large ecosystem and community support
- ✅ Excellent developer tools</p>
<p><strong>Disadvantages</strong>:
- ❌ Steep learning curve for beginners
- ❌ Frequent updates may require migration effort
- ❌ JSX syntax unconventional for some developers</p>
<h4 id="423-build-tool-vite">4.2.3 Build Tool: Vite</h4>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Version</strong></td>
<td>rolldown-vite 7.2.5</td>
</tr>
<tr>
<td><strong>Type</strong></td>
<td>Frontend Build Tool</td>
</tr>
</tbody>
</table>
<p><strong>Advantages</strong>:
- ✅ Extremely fast hot module replacement (HMR)
- ✅ Native ES modules support
- ✅ Optimized production builds
- ✅ Simple configuration</p>
<p><strong>Disadvantages</strong>:
- ❌ Less mature than Webpack
- ❌ Some plugins may not be compatible</p>
<h3 id="43-libraries-and-middleware">4.3 Libraries and Middleware</h3>
<h4 id="431-backend-libraries">4.3.1 Backend Libraries</h4>
<table>
<thead>
<tr>
<th>Library</th>
<th>Purpose</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>uvicorn</strong></td>
<td>ASGI server for FastAPI</td>
<td>Latest</td>
</tr>
<tr>
<td><strong>pydantic</strong></td>
<td>Data validation and serialization</td>
<td>Latest</td>
</tr>
<tr>
<td><strong>httpx</strong></td>
<td>HTTP client for OSRM API calls</td>
<td>Latest</td>
</tr>
<tr>
<td><strong>python-multipart</strong></td>
<td>Form data parsing</td>
<td>Latest</td>
</tr>
</tbody>
</table>
<h4 id="432-frontend-libraries">4.3.2 Frontend Libraries</h4>
<table>
<thead>
<tr>
<th>Library</th>
<th>Purpose</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>react-leaflet</strong></td>
<td>React components for Leaflet maps</td>
<td>5.0.0</td>
</tr>
<tr>
<td><strong>leaflet</strong></td>
<td>Interactive map library</td>
<td>1.9.4</td>
</tr>
</tbody>
</table>
<h3 id="44-external-apis">4.4 External APIs</h3>
<h4 id="441-osrm-open-source-routing-machine">4.4.1 OSRM (Open Source Routing Machine)</h4>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Base URL</strong></td>
<td><code>http://router.project-osrm.org</code></td>
</tr>
<tr>
<td><strong>Profile</strong></td>
<td>Bicycle routing</td>
</tr>
<tr>
<td><strong>Timeout</strong></td>
<td>10 seconds</td>
</tr>
</tbody>
</table>
<p><strong>Endpoints Used</strong>:</p>
<pre><code>GET /route/v1/bike/{coordinates}
Parameters:
- overview=full
- geometries=geojson
- alternatives=true/false
- steps=true
</code></pre>
<p><strong>Advantages</strong>:
- ✅ Free public API for bicycle routing
- ✅ Real road geometry data
- ✅ Support for alternative routes
- ✅ Turn-by-turn navigation data</p>
<p><strong>Disadvantages</strong>:
- ❌ Rate limits on public server
- ❌ No guaranteed uptime
- ❌ Limited to road network coverage</p>
<p><strong>Fallback Strategy</strong>: When OSRM is unavailable, the system falls back to geometric interpolation using Haversine distance calculations.</p>
<h3 id="45-cors-configuration">4.5 CORS Configuration</h3>
<pre><code class="language-python">app.add_middleware(
    CORSMiddleware,
    allow_origin_regex=r&quot;^https?://(localhost|127\.0\.0\.1)(:\d+)?$&quot;,
    allow_credentials=True,
    allow_methods=[&quot;*&quot;],
    allow_headers=[&quot;*&quot;],
)
</code></pre>
<hr />
<h2 id="5-structure-of-the-source-code">5. Structure of the Source Code</h2>
<h3 id="51-project-directory-structure">5.1 Project Directory Structure</h3>
<pre><code>bbp-road-app/
├── README.md                    # Project documentation
├── backend/                     # Python FastAPI backend
│   ├── main.py                  # Main application file (2144 lines)
│   ├── requirements.txt         # Python dependencies
│   └── test_routing.py          # Routing algorithm tests
├── frontend/                    # React TypeScript frontend
│   ├── index.html               # HTML entry point
│   ├── package.json             # Node.js dependencies
│   ├── tsconfig.json            # TypeScript configuration
│   ├── tsconfig.app.json        # App-specific TS config
│   ├── tsconfig.node.json       # Node-specific TS config
│   ├── vite.config.ts           # Vite build configuration
│   └── src/                     # Source code
│       ├── main.tsx             # React entry point
│       ├── App.tsx              # Main application component
│       ├── AppContext.tsx       # Global state management
│       ├── api.ts               # API client functions
│       ├── index.css            # Global styles
│       ├── Layout.tsx           # Page layout component
│       ├── LoginPage.tsx        # User login page
│       ├── DashboardPage.tsx    # Dashboard with statistics
│       ├── SegmentsPage.tsx     # Segment management
│       ├── ReportsPage.tsx      # Report submission
│       ├── RoutePlanningPage.tsx # Route planning interface
│       ├── TripsPage.tsx        # Trip creation
│       ├── TripHistoryPage.tsx  # Trip history view
│       ├── AutoDetectionPage.tsx # Auto-detection feature
│       ├── SettingsPage.tsx     # User settings
│       └── MapView.tsx          # Leaflet map component
└── node-v20.19.0-win-x64/       # Bundled Node.js runtime
    └── node-v20.19.0-win-x64/
        ├── node.exe
        ├── npm.cmd
        └── npx.cmd
</code></pre>
<h3 id="52-backend-architecture-mainpy">5.2 Backend Architecture (main.py)</h3>
<p>The backend follows a <strong>layered service architecture</strong>:</p>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                    API Layer (FastAPI)                       │
│  Endpoints: /api/users, /api/segments, /api/trips, etc.     │
├─────────────────────────────────────────────────────────────┤
│                    Service Layer                             │
│  ┌─────────────────┐ ┌─────────────────┐ ┌────────────────┐ │
│  │ WeatherService  │ │ RoutingService  │ │ AggregationSvc │ │
│  │ - get_weather() │ │ - fetch_osrm()  │ │ - aggregate()  │ │
│  │ - get_recommend │ │ - score_route() │ │ - vote()       │ │
│  └─────────────────┘ └─────────────────┘ └────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│                    Data Models (Pydantic)                    │
│  UserCreate, SegmentCreate, ReportCreate, TripCreate, etc.  │
├─────────────────────────────────────────────────────────────┤
│                    Data Storage Layer                        │
│  USERS: Dict, SEGMENTS: Dict, REPORTS: Dict, TRIPS: Dict    │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h4 id="521-module-organization-mainpy-sections">5.2.1 Module Organization (main.py sections)</h4>
<table>
<thead>
<tr>
<th>Lines</th>
<th>Section</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1-130</td>
<td>Internationalization (i18n)</td>
<td>Translation dictionaries and helper functions</td>
</tr>
<tr>
<td>131-230</td>
<td>Weather Service</td>
<td>Mock weather data generation</td>
</tr>
<tr>
<td>231-300</td>
<td>OSRM Integration</td>
<td>Route fetching from OSRM API</td>
</tr>
<tr>
<td>300-400</td>
<td>Route Utilities</td>
<td>Perpendicular waypoint calculation, route similarity detection</td>
</tr>
<tr>
<td>400-500</td>
<td>Geo Utilities</td>
<td>Haversine distance, path generation, duration estimation</td>
</tr>
<tr>
<td>500-650</td>
<td>Privacy Helpers</td>
<td>Location obfuscation, trip geometry sanitization</td>
</tr>
<tr>
<td>650-720</td>
<td>Aggregation Service</td>
<td>Weighted voting algorithm for report aggregation</td>
</tr>
<tr>
<td>720-800</td>
<td>Data Storage &amp; Schemas</td>
<td>In-memory stores and Pydantic models</td>
</tr>
<tr>
<td>800-900</td>
<td>Demo Data Seeding</td>
<td>Sample data initialization</td>
</tr>
<tr>
<td>900-1200</td>
<td>CRUD Endpoints</td>
<td>Users, Segments, Reports, Trips</td>
</tr>
<tr>
<td>1200-1350</td>
<td>Auto-Detection</td>
<td>Sensor-based pothole detection logic</td>
</tr>
<tr>
<td>1350-1500</td>
<td>Settings &amp; Weather API</td>
<td>User settings, weather endpoints</td>
</tr>
<tr>
<td>1500-1600</td>
<td>Route Preview</td>
<td>Multi-route preview endpoint</td>
</tr>
<tr>
<td>1600-1700</td>
<td>i18n API</td>
<td>Translation endpoints</td>
</tr>
<tr>
<td>1700-2144</td>
<td>Path Search</td>
<td>Generate &amp; Evaluate algorithm implementation</td>
</tr>
</tbody>
</table>
<h3 id="53-frontend-architecture">5.3 Frontend Architecture</h3>
<p>The frontend follows a <strong>component-based architecture</strong> with centralized state management:</p>
<pre><code>┌────────────────────────────────────────────────────────────┐
│                      App.tsx                                │
│                    (Root Component)                         │
├────────────────────────────────────────────────────────────┤
│                    AppContext.tsx                           │
│              (Global State: darkMode, language, t())        │
├────────────────────────────────────────────────────────────┤
│                     Layout.tsx                              │
│              (Navigation, Header, Sidebar)                  │
├──────────────┬──────────────┬──────────────┬───────────────┤
│ DashboardPage│ SegmentsPage │ ReportsPage  │RoutePlanning  │
│              │              │              │    Page       │
├──────────────┼──────────────┼──────────────┼───────────────┤
│  TripsPage   │TripHistory   │AutoDetection │ SettingsPage  │
│              │    Page      │    Page      │               │
├──────────────┴──────────────┴──────────────┴───────────────┤
│                      MapView.tsx                            │
│               (Leaflet Map Component)                       │
├────────────────────────────────────────────────────────────┤
│                        api.ts                               │
│              (API Client Functions)                         │
└────────────────────────────────────────────────────────────┘
</code></pre>
<h4 id="531-component-descriptions">5.3.1 Component Descriptions</h4>
<table>
<thead>
<tr>
<th>Component</th>
<th>Responsibility</th>
<th>Lines</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>App.tsx</strong></td>
<td>Root component, routing logic, user state</td>
<td>~70</td>
</tr>
<tr>
<td><strong>AppContext.tsx</strong></td>
<td>Global state provider (dark mode, i18n)</td>
<td>~330</td>
</tr>
<tr>
<td><strong>Layout.tsx</strong></td>
<td>Navigation sidebar, header, page structure</td>
<td>~200</td>
</tr>
<tr>
<td><strong>DashboardPage.tsx</strong></td>
<td>Statistics cards, segment map, aggregation trigger</td>
<td>~314</td>
</tr>
<tr>
<td><strong>SegmentsPage.tsx</strong></td>
<td>Segment CRUD, map visualization</td>
<td>~241</td>
</tr>
<tr>
<td><strong>ReportsPage.tsx</strong></td>
<td>Report submission, confirmation workflow</td>
<td>~281</td>
</tr>
<tr>
<td><strong>RoutePlanningPage.tsx</strong></td>
<td>Route search, multi-route display, weather</td>
<td>~618</td>
</tr>
<tr>
<td><strong>TripsPage.tsx</strong></td>
<td>Trip creation with OSRM integration</td>
<td>~200</td>
</tr>
<tr>
<td><strong>TripHistoryPage.tsx</strong></td>
<td>Historical trip listing</td>
<td>~150</td>
</tr>
<tr>
<td><strong>AutoDetectionPage.tsx</strong></td>
<td>Sensor-based detection interface</td>
<td>~200</td>
</tr>
<tr>
<td><strong>SettingsPage.tsx</strong></td>
<td>User preferences configuration</td>
<td>~250</td>
</tr>
<tr>
<td><strong>MapView.tsx</strong></td>
<td>Reusable Leaflet map wrapper</td>
<td>~150</td>
</tr>
<tr>
<td><strong>api.ts</strong></td>
<td>HTTP client, type definitions</td>
<td>~337</td>
</tr>
</tbody>
</table>
<h3 id="54-data-flow-diagram">5.4 Data Flow Diagram</h3>
<pre><code>┌──────────┐    HTTP/JSON    ┌──────────┐    Internal    ┌──────────┐
│  React   │ ◄────────────► │  FastAPI │ ◄────────────► │ In-Memory│
│ Frontend │                 │  Backend │                │   Store  │
└──────────┘                 └──────────┘                └──────────┘
     │                            │
     │                            │ HTTP/JSON
     │                            ▼
     │                       ┌──────────┐
     │                       │   OSRM   │
     │                       │  Server  │
     │                       └──────────┘
     │
     │ WebSocket (Leaflet tiles)
     ▼
┌──────────┐
│OpenStreet│
│   Map    │
└──────────┘
</code></pre>
<hr />
<h2 id="6-testing">6. Testing</h2>
<h3 id="61-testing-strategy">6.1 Testing Strategy</h3>
<p>The testing strategy follows the Test Plan outlined in the Design Document (DD), with focus on:</p>
<ol>
<li><strong>Unit Testing</strong>: Individual function testing</li>
<li><strong>Integration Testing</strong>: API endpoint testing</li>
<li><strong>System Testing</strong>: End-to-end user scenario testing</li>
</ol>
<h3 id="62-test-environment">6.2 Test Environment</h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Configuration</th>
</tr>
</thead>
<tbody>
<tr>
<td>Backend</td>
<td>Python 3.10+, FastAPI TestClient</td>
</tr>
<tr>
<td>Frontend</td>
<td>Manual testing in Chrome/Firefox</td>
</tr>
<tr>
<td>OSRM</td>
<td>Public server (router.project-osrm.org)</td>
</tr>
<tr>
<td>Map Tiles</td>
<td>OpenStreetMap</td>
</tr>
</tbody>
</table>
<h3 id="63-system-test-cases">6.3 System Test Cases</h3>
<h4 id="test-case-1-user-registration-and-login">Test Case 1: User Registration and Login</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Test ID</strong></td>
<td>STC-001</td>
</tr>
<tr>
<td><strong>Objective</strong></td>
<td>Verify user can register and login successfully</td>
</tr>
<tr>
<td><strong>Preconditions</strong></td>
<td>Backend server running, Frontend accessible</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td>Username: "testuser"</td>
</tr>
<tr>
<td><strong>Steps</strong></td>
<td>1. Navigate to login page<br>2. Enter username "testuser"<br>3. Click "Login" button</td>
</tr>
<tr>
<td><strong>Expected Output</strong></td>
<td>User redirected to dashboard, username displayed in header</td>
</tr>
<tr>
<td><strong>Actual Result</strong></td>
<td>✅ PASSED - User successfully logged in</td>
</tr>
</tbody>
</table>
<h4 id="test-case-2-create-road-segment">Test Case 2: Create Road Segment</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Test ID</strong></td>
<td>STC-002</td>
</tr>
<tr>
<td><strong>Objective</strong></td>
<td>Verify user can create a new road segment</td>
</tr>
<tr>
<td><strong>Preconditions</strong></td>
<td>User logged in</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td>Start: (1.3521, 103.8198), End: (1.3621, 103.8298), Status: "optimal"</td>
</tr>
<tr>
<td><strong>Steps</strong></td>
<td>1. Navigate to Segments page<br>2. Enter coordinates<br>3. Select status<br>4. Click "Create"</td>
</tr>
<tr>
<td><strong>Expected Output</strong></td>
<td>New segment appears in list and on map</td>
</tr>
<tr>
<td><strong>Actual Result</strong></td>
<td>✅ PASSED - Segment created with correct coordinates</td>
</tr>
</tbody>
</table>
<h4 id="test-case-3-submit-condition-report">Test Case 3: Submit Condition Report</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Test ID</strong></td>
<td>STC-003</td>
</tr>
<tr>
<td><strong>Objective</strong></td>
<td>Verify user can submit a condition report</td>
</tr>
<tr>
<td><strong>Preconditions</strong></td>
<td>User logged in, at least one segment exists</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td>Segment ID: 1, Note: "Pothole near intersection"</td>
</tr>
<tr>
<td><strong>Steps</strong></td>
<td>1. Select segment from list<br>2. Navigate to Reports<br>3. Enter note<br>4. Click "Submit"</td>
</tr>
<tr>
<td><strong>Expected Output</strong></td>
<td>Report appears in list, aggregation updated</td>
</tr>
<tr>
<td><strong>Actual Result</strong></td>
<td>✅ PASSED - Report submitted successfully</td>
</tr>
</tbody>
</table>
<h4 id="test-case-4-report-confirmation">Test Case 4: Report Confirmation</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Test ID</strong></td>
<td>STC-004</td>
</tr>
<tr>
<td><strong>Objective</strong></td>
<td>Verify report confirmation updates aggregation</td>
</tr>
<tr>
<td><strong>Preconditions</strong></td>
<td>At least one unconfirmed report exists</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td>Report ID to confirm</td>
</tr>
<tr>
<td><strong>Steps</strong></td>
<td>1. Find unconfirmed report<br>2. Click "Confirm" button</td>
</tr>
<tr>
<td><strong>Expected Output</strong></td>
<td>Report marked as confirmed, weighted score updated</td>
</tr>
<tr>
<td><strong>Actual Result</strong></td>
<td>✅ PASSED - Confirmation status updated</td>
</tr>
</tbody>
</table>
<h4 id="test-case-5-route-planning-with-osrm">Test Case 5: Route Planning with OSRM</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Test ID</strong></td>
<td>STC-005</td>
</tr>
<tr>
<td><strong>Objective</strong></td>
<td>Verify route planning returns multiple alternatives</td>
</tr>
<tr>
<td><strong>Preconditions</strong></td>
<td>OSRM server accessible</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td>Origin: (1.3521, 103.8198), Destination: (1.332, 103.903), Preference: "balanced"</td>
</tr>
<tr>
<td><strong>Steps</strong></td>
<td>1. Navigate to Route Planning<br>2. Enter coordinates<br>3. Select preference<br>4. Click "Search Routes"</td>
</tr>
<tr>
<td><strong>Expected Output</strong></td>
<td>1-3 routes displayed with quality scores and tags</td>
</tr>
<tr>
<td><strong>Actual Result</strong></td>
<td>✅ PASSED - Multiple routes returned with scoring</td>
</tr>
</tbody>
</table>
<h4 id="test-case-6-route-quality-scoring-safety-first">Test Case 6: Route Quality Scoring (Safety First)</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Test ID</strong></td>
<td>STC-006</td>
</tr>
<tr>
<td><strong>Objective</strong></td>
<td>Verify safety_first preference prioritizes road quality</td>
</tr>
<tr>
<td><strong>Preconditions</strong></td>
<td>Segments with maintenance status exist near route</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td>Preference: "safety_first"</td>
</tr>
<tr>
<td><strong>Steps</strong></td>
<td>1. Search routes with safety_first preference<br>2. Compare route rankings</td>
</tr>
<tr>
<td><strong>Expected Output</strong></td>
<td>Route avoiding maintenance segments ranked first</td>
</tr>
<tr>
<td><strong>Actual Result</strong></td>
<td>✅ PASSED - Higher quality route recommended</td>
</tr>
</tbody>
</table>
<h4 id="test-case-7-weather-information-display">Test Case 7: Weather Information Display</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Test ID</strong></td>
<td>STC-007</td>
</tr>
<tr>
<td><strong>Objective</strong></td>
<td>Verify weather information shown with route</td>
</tr>
<tr>
<td><strong>Preconditions</strong></td>
<td>Route search completed</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td>Any route search</td>
</tr>
<tr>
<td><strong>Steps</strong></td>
<td>1. Complete route search<br>2. Observe weather panel</td>
</tr>
<tr>
<td><strong>Expected Output</strong></td>
<td>Weather conditions, temperature, cycling recommendation displayed</td>
</tr>
<tr>
<td><strong>Actual Result</strong></td>
<td>✅ PASSED - Weather data shown correctly</td>
</tr>
</tbody>
</table>
<h4 id="test-case-8-language-switching">Test Case 8: Language Switching</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Test ID</strong></td>
<td>STC-008</td>
</tr>
<tr>
<td><strong>Objective</strong></td>
<td>Verify UI language can be changed</td>
</tr>
<tr>
<td><strong>Preconditions</strong></td>
<td>User logged in</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td>Language selection: "中文" (Chinese)</td>
</tr>
<tr>
<td><strong>Steps</strong></td>
<td>1. Navigate to Settings<br>2. Change language to Chinese<br>3. Save settings</td>
</tr>
<tr>
<td><strong>Expected Output</strong></td>
<td>All UI labels displayed in Chinese</td>
</tr>
<tr>
<td><strong>Actual Result</strong></td>
<td>✅ PASSED - Language switched successfully</td>
</tr>
</tbody>
</table>
<h4 id="test-case-9-data-aggregation-trigger">Test Case 9: Data Aggregation Trigger</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Test ID</strong></td>
<td>STC-009</td>
</tr>
<tr>
<td><strong>Objective</strong></td>
<td>Verify bulk aggregation updates segment statuses</td>
</tr>
<tr>
<td><strong>Preconditions</strong></td>
<td>Multiple segments with reports exist</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td>Click "Trigger Aggregation" on Dashboard</td>
</tr>
<tr>
<td><strong>Steps</strong></td>
<td>1. Navigate to Dashboard<br>2. Click "Trigger Aggregation" button</td>
</tr>
<tr>
<td><strong>Expected Output</strong></td>
<td>Summary shows segments processed and status changes</td>
</tr>
<tr>
<td><strong>Actual Result</strong></td>
<td>✅ PASSED - Aggregation completed, status changes applied</td>
</tr>
</tbody>
</table>
<h4 id="test-case-10-auto-detection-simulation">Test Case 10: Auto-Detection Simulation</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Test ID</strong></td>
<td>STC-010</td>
</tr>
<tr>
<td><strong>Objective</strong></td>
<td>Verify accelerometer-based detection logic</td>
</tr>
<tr>
<td><strong>Preconditions</strong></td>
<td>Segment selected</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td>z_axis_peak: 20.0 m/s², speed: 5.0 m/s</td>
</tr>
<tr>
<td><strong>Steps</strong></td>
<td>1. Navigate to Auto Detection<br>2. Run detection on segment</td>
</tr>
<tr>
<td><strong>Expected Output</strong></td>
<td>Detection result shows "suboptimal" status with confidence score</td>
</tr>
<tr>
<td><strong>Actual Result</strong></td>
<td>✅ PASSED - Correct status detected</td>
</tr>
</tbody>
</table>
<h3 id="64-api-testing-results">6.4 API Testing Results</h3>
<table>
<thead>
<tr>
<th>Endpoint</th>
<th>Method</th>
<th>Test Result</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/api/users</code></td>
<td>POST</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/users</code></td>
<td>GET</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/segments</code></td>
<td>GET</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/segments</code></td>
<td>POST</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/segments/{id}/reports</code></td>
<td>POST</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/segments/{id}/reports</code></td>
<td>GET</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/reports/{id}/confirm</code></td>
<td>POST</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/segments/{id}/aggregate</code></td>
<td>GET</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/aggregation/trigger</code></td>
<td>POST</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/trips</code></td>
<td>POST</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/trips</code></td>
<td>GET</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/path/search</code></td>
<td>POST</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/weather</code></td>
<td>GET</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/users/{id}/settings</code></td>
<td>GET/PUT/PATCH</td>
<td>✅ PASSED</td>
</tr>
<tr>
<td><code>/api/i18n/translations</code></td>
<td>GET</td>
<td>✅ PASSED</td>
</tr>
</tbody>
</table>
<h3 id="65-routing-algorithm-test-script">6.5 Routing Algorithm Test Script</h3>
<p>A dedicated test script (<code>test_routing.py</code>) validates the routing algorithm:</p>
<pre><code class="language-python"># Test execution command:
python test_routing.py

# Test output example:
============================================================
ROUTE SEARCH TEST RESULTS
============================================================
Route Source: osrm
Algorithm: generate_and_evaluate
Candidates Generated: 3
Candidates Returned: 3

Route A (Rank 1):
  Distance: 4523m
  Duration: 7 min
  Quality Score: 92.5
  Tags: ['Recommended', 'Best Surface', 'Fastest']
  Source: osrm_direct

Route B (Rank 2):
  Distance: 4891m
  Duration: 8 min
  Quality Score: 85.3
  Tags: ['Alternative', 'Slightly Longer']
  Source: osrm_via_waypoint
============================================================
</code></pre>
<hr />
<h2 id="7-installation-instructions">7. Installation Instructions</h2>
<h3 id="71-prerequisites">7.1 Prerequisites</h3>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Version</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Python</strong></td>
<td>3.10 or higher</td>
<td>Required for backend</td>
</tr>
<tr>
<td><strong>Node.js</strong></td>
<td>20.x (included)</td>
<td>Bundled in package</td>
</tr>
<tr>
<td><strong>npm</strong></td>
<td>9.x+</td>
<td>Comes with Node.js</td>
</tr>
<tr>
<td><strong>Web Browser</strong></td>
<td>Chrome/Firefox/Edge</td>
<td>For frontend access</td>
</tr>
<tr>
<td><strong>Internet Connection</strong></td>
<td>Required</td>
<td>For OSRM API and map tiles</td>
</tr>
</tbody>
</table>
<h3 id="72-quick-start-windows">7.2 Quick Start (Windows)</h3>
<h4 id="step-1-extract-the-package">Step 1: Extract the Package</h4>
<pre><code class="language-powershell"># Navigate to the delivery folder
cd C:\path\to\DeliveryFolder\bbp-road-app
</code></pre>
<h4 id="step-2-start-backend-server">Step 2: Start Backend Server</h4>
<pre><code class="language-powershell"># Open PowerShell in backend directory
cd backend

# Create virtual environment (first time only)
python -m venv .venv

# Activate virtual environment
.venv\Scripts\activate

# Install dependencies (first time only)
pip install -r requirements.txt

# Start the server
uvicorn main:app --host 127.0.0.1 --port 8000
</code></pre>
<p>The backend will be running at: <code>http://127.0.0.1:8000</code></p>
<p>API documentation available at: <code>http://127.0.0.1:8000/docs</code></p>
<h4 id="step-3-start-frontend-development-server">Step 3: Start Frontend Development Server</h4>
<pre><code class="language-powershell"># Open a NEW PowerShell window
cd C:\path\to\DeliveryFolder\bbp-road-app\frontend

# Use bundled Node.js (optional, if Node.js not installed globally)
$env:PATH = &quot;..\node-v20.19.0-win-x64\node-v20.19.0-win-x64;&quot; + $env:PATH

# Install dependencies (first time only)
npm install

# Start development server
npm run dev
</code></pre>
<p>The frontend will be running at: <code>http://localhost:5173</code></p>
<h4 id="step-4-access-the-application">Step 4: Access the Application</h4>
<ol>
<li>Open a web browser</li>
<li>Navigate to <code>http://localhost:5173</code></li>
<li>Enter any username to login (e.g., "alice" for demo data)</li>
</ol>
<h3 id="73-detailed-installation-linuxmacos">7.3 Detailed Installation (Linux/macOS)</h3>
<h4 id="backend-setup">Backend Setup</h4>
<pre><code class="language-bash"># Navigate to backend
cd bbp-road-app/backend

# Create virtual environment
python3 -m venv .venv

# Activate (Linux/macOS)
source .venv/bin/activate

# Install dependencies
pip install -r requirements.txt

# Run server
uvicorn main:app --host 127.0.0.1 --port 8000
</code></pre>
<h4 id="frontend-setup">Frontend Setup</h4>
<pre><code class="language-bash"># Navigate to frontend
cd bbp-road-app/frontend

# Install Node.js dependencies
npm install

# Run development server
npm run dev
</code></pre>
<h3 id="74-production-build">7.4 Production Build</h3>
<h4 id="build-frontend-for-production">Build Frontend for Production</h4>
<pre><code class="language-powershell">cd frontend
npm run build
</code></pre>
<p>This creates optimized files in <code>frontend/dist/</code> that can be served by any static file server.</p>
<h3 id="75-configuration">7.5 Configuration</h3>
<h4 id="backend-configuration">Backend Configuration</h4>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--host</code></td>
<td>127.0.0.1</td>
<td>Server bind address</td>
</tr>
<tr>
<td><code>--port</code></td>
<td>8000</td>
<td>Server port</td>
</tr>
<tr>
<td><code>OSRM_BASE_URL</code></td>
<td>router.project-osrm.org</td>
<td>OSRM server URL</td>
</tr>
<tr>
<td><code>OSRM_TIMEOUT</code></td>
<td>10.0</td>
<td>OSRM request timeout (seconds)</td>
</tr>
</tbody>
</table>
<h4 id="frontend-configuration">Frontend Configuration</h4>
<p>Edit <code>frontend/.env</code> or <code>frontend/.env.local</code>:</p>
<pre><code class="language-env">VITE_API_BASE=http://127.0.0.1:8000/api
</code></pre>
<h3 id="76-troubleshooting">7.6 Troubleshooting</h3>
<table>
<thead>
<tr>
<th>Issue</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Port 8000 in use</strong></td>
<td>Change port: <code>uvicorn main:app --port 8001</code></td>
</tr>
<tr>
<td><strong>CORS errors</strong></td>
<td>Ensure backend is running on 127.0.0.1:8000</td>
</tr>
<tr>
<td><strong>npm install fails</strong></td>
<td>Delete <code>node_modules</code> and <code>package-lock.json</code>, retry</td>
</tr>
<tr>
<td><strong>Map not loading</strong></td>
<td>Check internet connection (requires OpenStreetMap tiles)</td>
</tr>
<tr>
<td><strong>OSRM timeout</strong></td>
<td>Increase timeout in code or use fallback routes</td>
</tr>
<tr>
<td><strong>Python not found</strong></td>
<td>Install Python 3.10+ and add to PATH</td>
</tr>
</tbody>
</table>
<h3 id="77-verification-steps">7.7 Verification Steps</h3>
<p>After installation, verify the system is working:</p>
<ol>
<li>
<p><strong>Backend Health Check</strong>:
   <code>curl http://127.0.0.1:8000/
   # Expected: {"ok": true, "message": "BBP backend ready"}</code></p>
</li>
<li>
<p><strong>API Documentation</strong>:</p>
</li>
<li>Open <code>http://127.0.0.1:8000/docs</code> in browser</li>
<li>
<p>Should display Swagger UI</p>
</li>
<li>
<p><strong>Frontend</strong>:</p>
</li>
<li>Open <code>http://localhost:5173</code></li>
<li>Login with username "alice"</li>
<li>Dashboard should show demo data</li>
</ol>
<hr />
<h2 id="8-effort-spent">8. Effort Spent</h2>
<h3 id="81-individual-effort">8.1 Individual Effort</h3>
<table>
<thead>
<tr>
<th>Team Member</th>
<th>Task</th>
<th>Hours</th>
</tr>
</thead>
<tbody>
<tr>
<td>[Hu Xu Yan]</td>
<td>Backend API Development</td>
<td>XX</td>
</tr>
<tr>
<td>[Hu Xu Yan]</td>
<td>Frontend Development</td>
<td>XX</td>
</tr>
<tr>
<td>[Hu Xu Yan]</td>
<td>OSRM Integration</td>
<td>XX</td>
</tr>
<tr>
<td>[Hu Xu Yan]</td>
<td>Testing</td>
<td>XX</td>
</tr>
<tr>
<td>[Hu Xu Yan]</td>
<td>Documentation</td>
<td>XX</td>
</tr>
<tr>
<td><strong>[Hu Xu Yan] Total</strong></td>
<td></td>
<td><strong>XX</strong></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Team Member 2]</td>
<td>[Tasks]</td>
<td>XX</td>
</tr>
<tr>
<td><strong>[Team Member 2] Total</strong></td>
<td></td>
<td><strong>XX</strong></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Team Member 3]</td>
<td>[Tasks]</td>
<td>XX</td>
</tr>
<tr>
<td><strong>[Team Member 3] Total</strong></td>
<td></td>
<td><strong>XX</strong></td>
</tr>
</tbody>
</table>
<h3 id="82-effort-summary">8.2 Effort Summary</h3>
<table>
<thead>
<tr>
<th>Phase</th>
<th>Hours</th>
<th>Percentage</th>
</tr>
</thead>
<tbody>
<tr>
<td>Requirements Analysis</td>
<td>X</td>
<td>X%</td>
</tr>
<tr>
<td>Design</td>
<td>X</td>
<td>X%</td>
</tr>
<tr>
<td>Implementation</td>
<td>X</td>
<td>X%</td>
</tr>
<tr>
<td>Testing</td>
<td>X</td>
<td>X%</td>
</tr>
<tr>
<td>Documentation</td>
<td>X</td>
<td>X%</td>
</tr>
<tr>
<td><strong>Total</strong></td>
<td><strong>XX</strong></td>
<td><strong>100%</strong></td>
</tr>
</tbody>
</table>
<h3 id="83-generative-ai-usage-declaration">8.3 Generative AI Usage Declaration</h3>
<p>In accordance with course requirements, we declare the use of Generative AI (GitHub Copilot / Claude) in the following capacities:</p>
<table>
<thead>
<tr>
<th>Task</th>
<th>AI Tool</th>
<th>Input (Prompt)</th>
<th>Output</th>
<th>Verification Method</th>
</tr>
</thead>
<tbody>
<tr>
<td>Code Documentation</td>
<td>GitHub Copilot</td>
<td>"Add docstrings to routing functions"</td>
<td>Function documentation</td>
<td>Manual review, accuracy check</td>
</tr>
<tr>
<td>ITD Document Drafting</td>
<td>Claude</td>
<td>Project code + ITD requirements</td>
<td>Document structure and content</td>
<td>Manual review, fact verification</td>
</tr>
<tr>
<td>Test Case Generation</td>
<td>Claude</td>
<td>"Generate system test cases for route planning"</td>
<td>Test case templates</td>
<td>Execution and validation</td>
</tr>
<tr>
<td>Code Review</td>
<td>GitHub Copilot</td>
<td>Code snippets for review</td>
<td>Improvement suggestions</td>
<td>Manual assessment</td>
</tr>
</tbody>
</table>
<p><strong>Verification Process</strong>:
1. All AI-generated code was reviewed for correctness
2. AI-generated documentation was verified against actual implementation
3. Test cases were executed to confirm validity
4. No AI output was used without human verification</p>
<hr />
<h2 id="9-references">9. References</h2>
<h3 id="91-technical-documentation">9.1 Technical Documentation</h3>
<ol>
<li><strong>FastAPI Documentation</strong> - https://fastapi.tiangolo.com/</li>
<li><strong>React Documentation</strong> - https://react.dev/</li>
<li><strong>TypeScript Documentation</strong> - https://www.typescriptlang.org/docs/</li>
<li><strong>Vite Documentation</strong> - https://vitejs.dev/</li>
<li><strong>Leaflet Documentation</strong> - https://leafletjs.com/reference.html</li>
<li><strong>React-Leaflet Documentation</strong> - https://react-leaflet.js.org/</li>
<li><strong>OSRM API Documentation</strong> - http://project-osrm.org/docs/v5.24.0/api/</li>
<li><strong>Pydantic Documentation</strong> - https://docs.pydantic.dev/</li>
</ol>
<h3 id="92-course-materials">9.2 Course Materials</h3>
<ol>
<li><strong>RASD Document</strong> - Requirements Analysis and Specification Document (BBP Project)</li>
<li><strong>DD Document</strong> - Design Document (BBP Project)</li>
<li><strong>Course Slides</strong> - Software Engineering 2, Politecnico di Milano</li>
</ol>
<h3 id="93-standards">9.3 Standards</h3>
<ol>
<li><strong>REST API Design Guidelines</strong> - https://restfulapi.net/</li>
<li><strong>GeoJSON Specification</strong> - RFC 7946</li>
<li><strong>Polyline Encoding</strong> - Google Polyline Algorithm</li>
</ol>
<h3 id="94-tools">9.4 Tools</h3>
<ol>
<li><strong>Visual Studio Code</strong> - IDE</li>
<li><strong>Git</strong> - Version Control</li>
<li><strong>Postman</strong> - API Testing</li>
<li><strong>Chrome DevTools</strong> - Frontend Debugging</li>
</ol>
<hr />
<h2 id="appendix-a-api-endpoint-reference">Appendix A: API Endpoint Reference</h2>
<h3 id="a1-user-endpoints">A.1 User Endpoints</h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST</td>
<td><code>/api/users</code></td>
<td>Create or get user</td>
</tr>
<tr>
<td>GET</td>
<td><code>/api/users</code></td>
<td>List all users</td>
</tr>
<tr>
<td>GET</td>
<td><code>/api/users/{id}/settings</code></td>
<td>Get user settings</td>
</tr>
<tr>
<td>PUT</td>
<td><code>/api/users/{id}/settings</code></td>
<td>Update all settings</td>
</tr>
<tr>
<td>PATCH</td>
<td><code>/api/users/{id}/settings</code></td>
<td>Partial update settings</td>
</tr>
</tbody>
</table>
<h3 id="a2-segment-endpoints">A.2 Segment Endpoints</h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td><code>/api/segments</code></td>
<td>List all segments</td>
</tr>
<tr>
<td>POST</td>
<td><code>/api/segments</code></td>
<td>Create segment</td>
</tr>
<tr>
<td>GET</td>
<td><code>/api/segments/{id}/aggregate</code></td>
<td>Get aggregation result</td>
</tr>
<tr>
<td>POST</td>
<td><code>/api/segments/{id}/auto-detect</code></td>
<td>Run auto-detection</td>
</tr>
<tr>
<td>POST</td>
<td><code>/api/segments/{id}/apply-detection</code></td>
<td>Apply detection result</td>
</tr>
</tbody>
</table>
<h3 id="a3-report-endpoints">A.3 Report Endpoints</h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td><code>/api/segments/{id}/reports</code></td>
<td>List reports for segment</td>
</tr>
<tr>
<td>POST</td>
<td><code>/api/segments/{id}/reports</code></td>
<td>Create report</td>
</tr>
<tr>
<td>POST</td>
<td><code>/api/reports/{id}/confirm</code></td>
<td>Confirm report</td>
</tr>
<tr>
<td>POST</td>
<td><code>/api/reports/batch-confirm</code></td>
<td>Batch confirm</td>
</tr>
</tbody>
</table>
<h3 id="a4-trip-endpoints">A.4 Trip Endpoints</h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td><code>/api/trips</code></td>
<td>List trips</td>
</tr>
<tr>
<td>POST</td>
<td><code>/api/trips</code></td>
<td>Create trip</td>
</tr>
<tr>
<td>GET</td>
<td><code>/api/trips/{id}</code></td>
<td>Get trip details</td>
</tr>
<tr>
<td>DELETE</td>
<td><code>/api/trips/{id}</code></td>
<td>Delete trip</td>
</tr>
</tbody>
</table>
<h3 id="a5-route-planning-endpoints">A.5 Route Planning Endpoints</h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST</td>
<td><code>/api/routes</code></td>
<td>Preview routes</td>
</tr>
<tr>
<td>POST</td>
<td><code>/api/path/search</code></td>
<td>Search routes with scoring</td>
</tr>
</tbody>
</table>
<h3 id="a6-utility-endpoints">A.6 Utility Endpoints</h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td><code>/api/stats</code></td>
<td>Get statistics</td>
</tr>
<tr>
<td>GET</td>
<td><code>/api/weather</code></td>
<td>Get weather data</td>
</tr>
<tr>
<td>GET</td>
<td><code>/api/i18n/translations</code></td>
<td>Get translations</td>
</tr>
<tr>
<td>GET</td>
<td><code>/api/i18n/languages</code></td>
<td>Get available languages</td>
</tr>
<tr>
<td>POST</td>
<td><code>/api/aggregation/trigger</code></td>
<td>Trigger bulk aggregation</td>
</tr>
</tbody>
</table>
<hr />
<p><em>Document generated: January 30, 2026</em></p>
<p><em>End of Document</em></p>

<footer style="margin-top: 60px; padding-top: 20px; border-top: 1px solid #e5e7eb; text-align: center; color: #64748b; font-size: 0.9em;">
    <p>Implementation and Test Deliverable (ITD) - Best Bike Paths (BBP)</p>
    <p>Software Engineering 2 - Politecnico di Milano</p>
    <p>Generated: January 30, 2026</p>
</footer>
</body>
</html>